(function(e){function t(t){for(var i,s,r=t[0],c=t[1],l=t[2],f=0,d=[];f<r.length;f++)s=r[f],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(i=!1)}i&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},o={index:0},a=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},2042:function(e,t,n){"use strict";n("c473")},"3f1b":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=n("5c96"),a=n.n(o),s=(n("0fae"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)}),r=[],c=(n("c975"),n("96cf"),n("1da1")),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"main"+(e.darkmode?" dark_mode":""),attrs:{id:"app_"}},[n("div",{attrs:{id:"main"}},[n("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[n("el-header",{attrs:{id:"header"}},[e._l(e.tool_bar_list,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],key:t.name,class:"header_item "+(t.enable?"enable":"disable"),style:"width:"+t.width+"px;"+t.style},[n("div",{staticClass:"header_btn",on:{click:function(e){t.enable&&"btn"!=t.type&&t.click()}}},[n("i",{class:t.icon}),e._v(" "+e._s(t.title)+" "),"btn"==t.type?n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(e){return t.click()}},model:{value:t.enable,callback:function(n){e.$set(t,"enable",n)},expression:"item.enable"}}):e._e()],1),n("div",{staticClass:"header_name"},[e._v(e._s(t.name))])])})),n("div",{staticClass:"header_item",staticStyle:{width:"100px"}},[n("div",{staticClass:"header_btn"},[e._v(" "+e._s(e.count)+" ")]),n("div",{staticClass:"header_name"},[e._v("字数统计")])])],2),n("el-main",{class:e.full_screen?"full_screen vditor":"vditor",staticStyle:{height:"calc(100vh - 60px)",padding:"0px",position:"relative",top:"60px","text-align":"left"},attrs:{id:"md_container"}}),e.full_screen?n("el-button",{staticClass:"full_screen_button",attrs:{icon:"el-icon-full-screen"},on:{click:function(t){e.full_screen=!1}}}):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.pushed_pic_config.show,expression:"pushed_pic_config.show"}],staticClass:"big_board"},[n("div",{staticClass:"behind_",on:{click:function(t){e.pushed_pic_config.show=!1}}}),n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.pushed_pic_config.loading,expression:"pushed_pic_config.loading"}],staticClass:"edit_board"},[n("img",{staticStyle:{width:"100%"},attrs:{id:"pushed_image",src:e.pushed_pic_config.base64||e.pushed_pic_config.url}}),n("p",{directives:[{name:"show",rawName:"v-show",value:""==e.pushed_pic_config.base64&&""==e.pushed_pic_config.url&&!e.pushed_pic_config.pushed,expression:"pushed_pic_config.base64=='' && pushed_pic_config.url==''  && !pushed_pic_config.pushed"}],staticStyle:{"text-align":"center"}},[e._v("NO IMAGE!")]),n("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"照片链接"},model:{value:e.pushed_pic_config.url,callback:function(t){e.$set(e.pushed_pic_config,"url",t)},expression:"pushed_pic_config.url"}}),n("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"照片链接"},model:{value:e.pushed_pic_config.name,callback:function(t){e.$set(e.pushed_pic_config,"name",t)},expression:"pushed_pic_config.name"}}),e.pushed_pic_config.url.length>0&&e.pushed_pic_config.name.length>0?n("div",{staticClass:"btn green",on:{click:e.__upload_pic_to_itee_file}},[e._v("上传图片")]):e._e()],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.md_head.show,expression:"md_head.show"}],staticClass:"big_board"},[n("div",{staticClass:"behind_",on:{click:function(t){e.md_head.show=!1}}}),n("el-card",{directives:[{name:"show",rawName:"v-show",value:e.md_head.show,expression:"md_head.show"},{name:"loading",rawName:"v-loading",value:e.md_head.loading,expression:"md_head.loading"}],staticClass:"edit_board"},[n("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"题目"},model:{value:e.md_head.title,callback:function(t){e.$set(e.md_head,"title",t)},expression:"md_head.title"}}),n("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"备注（一般为作者名）"},model:{value:e.md_head.remark,callback:function(t){e.$set(e.md_head,"remark",t)},expression:"md_head.remark"}}),e.md_head.title.length>0?n("div",{staticClass:"btn green",on:{click:function(t){return e.add_head()}}},[e._v("添加到文档中")]):e._e()],1)],1),e.first_load?n("div",{staticClass:"first_load_cover"},[n("div",{staticClass:"first_load_board"},[e.read_mode?n("div",[e._v(" "+e._s(e.cover_msg)+" ")]):n("div",[e._v(" Choose a Operation: "),n("div",{staticClass:"btn green iconfont icon-new",on:{click:e.__init_a_blank_project}},[e._v(" Create")]),e.gitee_enable?n("div",{staticClass:"btn green iconfont icon-storage",on:{click:e.__init_an_online_project}},[e._v(" Open")]):e._e()])])]):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.file_config.show,expression:"file_config.show"}],staticClass:"big_board"},[n("div",{staticClass:"behind_",on:{click:function(t){e.file_config.show=!1}}}),!e.read_mode&&e.file_config.show?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.file_config.loading,expression:"file_config.loading"}],staticClass:"config_board file_config_board"},[n("div",{staticClass:"board_title"},[e._v(e._s(e.file_config.title))]),n("div",{staticStyle:{display:"flex"}},[n("div",{staticClass:"btn blue iconfont icon-refresh",on:{click:e.__get_gitee_files}}),n("div",{staticClass:"btn blue iconfont icon-new",on:{click:e.__add_file_group}}),n("div",{staticClass:"btn green iconfont icon-upload",on:{click:e.__upload_file_group}})]),e._l(e.file_config.groups,(function(t,i){return n("div",{key:t.name,staticClass:"group_item"},[n("p",{staticStyle:{"font-size":"1.2rem","font-weight":"bold","line-height":"20px",margin:"5px 0px"}},[e._v(e._s(t.name))]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length<=0,expression:"group.list.length<=0"}],staticClass:"btn red",staticStyle:{width:"calc(100% - 30px)"},on:{click:function(t){return e.__delete_file_group(i)}}},[e._v("Delete Group")]),n("draggable",{staticClass:"list-group",attrs:{list:t.list,group:"files"}},e._l(t.list,(function(t){return n("div",{key:t.path,staticClass:"file_item list-group-item"},[n("div",{staticStyle:{width:"calc(100% - 30px)",float:"left","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},on:{click:function(n){return e.__load_gitee_file(t.path,t.sha)}}},[n("i",{staticClass:"el-icon-document"}),e._v(e._s(t.path)+" ")])])})),0)],1)}))],2):e._e()])],1)],1)])},u=[],f=(n("99af"),n("4160"),n("a15b"),n("d81d"),n("fb6a"),n("a434"),n("b0c0"),n("a9e3"),n("d3b7"),n("ac1f"),n("25f0"),n("6062"),n("3ca3"),n("5319"),n("841c"),n("1276"),n("159b"),n("ddb0"),n("b85c")),d=n("b76a"),_=n.n(d),h=n("d722"),p=(n("be35"),n("ff41")),g=n.n(p),m=(n("b642"),window.matchMedia("(prefers-color-scheme: dark)").matches),v={name:"HelloWorld",props:{},components:{draggable:_.a},data:function(){var e=this;return{gitee_info:{enable:!1,username:"",repos:"",token:""},editor:null,count:0,show_menu:!1,server_mode:!1,full_screen:!1,read_mode:!1,cover_msg:"加载中...",darkmode:m,loading:!1,first_load:!0,gitee_enable:!1,file_name:"untitled",file_sha:"null",file_type:"mdb",online_file:!1,selected_node:null,selected_edge:null,predefineColors:["#eeeeee","#ffffff","#000000","#b39ddb","#f44336","#009688","#0d47a1"],request_lock:!1,zoom:0,md_head:{show:!1,title:"",remark:"",loading:!1},tool_bar_list:[{name:"Xiaohao Liu",width:100,style:"margin-right: 20px;padding-right: 20px;",enable:!0,show:!0,icon:"",title:"MarkBox",click:function(){e.index()}},{name:"文件名",width:200,style:"margin-right: 20px;padding-right: 20px;",enable:!0,show:!0,icon:"",title:"null",click:function(){e.__file_share_link()}},{name:"图片",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-pic",title:"",click:function(){e.__tool_add_pic()}},{name:"上传",width:40,style:"",enable:!0,show:!0,icon:"iconfont icon-upload",title:"",click:function(){e.__upload_to_gitee()}},{name:"深色模式",width:100,style:"",enable:this.darkmode,show:!0,type:"btn",icon:"",title:"",click:function(){e.darkmode=!e.darkmode,e.tool_bar_list[e.tool_map["darkmode"]].enable=e.darkmode}},{name:"添加头",width:40,style:"",enable:!0,show:!0,icon:"el-icon-menu",title:"",click:function(){e.md_head.show=!e.md_head.show}},{name:"登出",width:60,style:"float:right",enable:!0,show:!0,icon:"el-icon-coffee-cup",title:"",click:function(){Object(h["removeToken"])(),e.$router.push("/login")}}],tool_map:{file:1,pic:2,upload:3,darkmode:4},read_mode_bar:new Set([0,1,4]),pushed_pic_config:{show:!1,name:"",base64:"",pushed:!1,raw:"",loading:!1,url:""},file_config:{show:!1,title:"Files",label:"",loading:!1,groups:[],files:new Set},markdown_mode:!1}},watch:{darkmode:function(e,t){t?this.editor.setTheme("classic","light"):this.editor.setTheme("dark","dark")}},mounted:function(){var e=this;Object(h["getGiteeInfo"])().then((function(t){e.server_mode=!0,e.gitee_info=t,e.gitee_enable=e.gitee_info.enable})).catch((function(e){console.log(e)})).finally((function(){e.__init_read_mode(),e.__init_markdown(),e.__add_events(),e.read_mode&&e.__load_online_file()}))},methods:{index:function(){!this.read_mode&&this.gitee_enable?(this.file_config.show=!this.file_config.show,1==this.file_config.show&&this.can_request()&&(this.__get_gitee_files(),this.send_a_request())):alert("MarkBox\nDesined by Xiaohao Liu.\nGithub: WYKXLDZ")},__init_read_mode:function(){var e=this;this.gitee_enable||(this.read_mode=!0);var t={};window.location.search.substring(1).split("&").forEach((function(e){var n=e.split("=");t[n[0]]=n[1]}));try{var n={enable:!0,username:t["u"],repos:t["r"],token:""};this.file_sha=t["s"],this.file_name=t["n"].split(".mdb")[0],this.read_mode=!0,this.gAPI=new h["GiteeAPI"](n),this.gitee_info=n,this.tool_bar_list.forEach((function(t,n){e.read_mode_bar.has(n)||(t.show=!1)}))}catch(i){return this.read_mode?void(this.cover_msg="参数错误！"):void(this.gAPI=new h["GiteeAPI"](this.gitee_info))}},__load_online_file:function(){var e=this;this.can_request()&&(this.send_a_request(),this.loading=!0,this.gAPI.get_file_by_sha(this.file_sha).then((function(t){e.editor.setValue(e.__decode(t.data.content)),e.tool_bar_list[e.tool_map["file"]].title=e.file_name,e.loading=!1,e.online_file=!0,e.first_load=!1,document.getElementsByTagName("title")[0].innerText=e.file_name})).catch((function(t){e.cover_msg="Wrong\n"+t,console.log("wrong:",t),e.loading=!1})))},__init_markdown:function(){var e=this;this.editor=new g.a("md_container",{height:360,counter:{enable:!0,after:function(t){e.count=t}},preview:{hljs:{lineNumber:!0},markdown:{toc:!0}},outline:{enable:!0},toolbarConfig:{hide:!1},toolbar:[],cache:{enable:!1},theme:"classic",after:function(){e.tool_bar_list[e.tool_map["darkmode"]].enable=e.darkmode,e.darkmode&&e.editor.setTheme("dark","dark")}})},add_head:function(){this.editor.setValue(this.editor.html2md('<pre ><p class="head_title" style="text-align:center;font-size:2.2rem;font-weight:bold;border-bottom:4px double black;"> '+this.md_head.title+' </p><p style="text-align:center;font-size:1.2rem;font-weight:bold;"> '+this.md_head.remark+"</p> </pre>")+this.editor.getValue()),this.md_head.show=!1},send_a_request:function(){var e=this;this.request_lock=!0,setTimeout((function(){e.request_lock=!1}),2e3)},can_request:function(){return 1!=this.request_lock||(this.$notify({title:"请求速率过快",message:"2s后重试"}),!1)},__init_an_online_project:function(){this.file_config.show=!0,this.__get_gitee_files(),this.first_load=!1,this.online_file=!0},__init_a_blank_project:function(){this.tool_bar_list[this.tool_map["file"]].title=this.file_name,this.file_name="untitled",this.tool_bar_list[this.tool_map["file"]].title=this.file_name,this.first_load=!1,this.online_file=!1,document.getElementsByTagName("title")[0].innerText="new file"},__enable:function(e){this.tool_bar_list[this.tool_map[e]].enable=!0},__disable:function(e){this.tool_bar_list[this.tool_map[e]].enable=!1},__add_events:function(){this.__add_paste_event()},__add_keyboard_events:function(){var e=this;this.graph.bindKey("enter",(function(){e.__tool_add_sibling()})),this.graph.bindKey("ctrl+enter",(function(){e.__tool_add_child()})),this.graph.bindKey("backspace",(function(){e.__del_node()})),this.graph.bindKey("ctrl+c",(function(){var t=e.graph.getSelectedCells();if(t.length){var n=[];t.forEach((function(e){0!=e.store.data.idx&&n.push(e)})),e.graph.copy(n)}return!1})),this.graph.bindKey("ctrl+v",(function(){if(!e.graph.isClipboardEmpty()){var t=e.graph.paste({offset:32});e.graph.cleanSelection(),e.graph.select(t)}return!1})),this.graph.bindKey("ctrl+z",(function(){e.history.canUndo()&&e.graph.undo()})),this.graph.bindKey("ctrl+s",(function(){e.__upload_to_gitee()})),this.graph.bindKey("ctrl+n",(function(){e.__init_a_blank_project()}))},__add_paste_event:function(){var e=this,t=",.'\":; ";document.addEventListener("paste",(function(n){if(e.pushed_pic_config.show){var i=n.clipboardData&&n.clipboardData.items,o=null,a=new FileReader;if(i&&i.length)for(var s=0;s<i.length;s++)if(-1!==i[s].type.indexOf("image")){o=i[s].getAsFile();break}for(var r=e.file_name.substring(0,15).toLowerCase(),c=0;c<t.length;c++)r=r.split(t[c]).join("_");r+="_1.png",a.onload=function(t){e.pushed_pic_config.base64=t.target.result,e.pushed_pic_config.url=e.pushed_pic_config.base64,e.pushed_pic_config.name=r,e.pushed_pic_config.pushed=!1},o&&a.readAsDataURL(o)}}))},__tool_add_pic:function(){this.pushed_pic_config.show=!this.pushed_pic_config.show},__file_share_link:function(){var e=this;if(this.online_file){var t="http://wykxldz.gitee.io/markbox/?u="+this.gitee_info.username+"&r="+this.gitee_info.repos+"&s="+this.file_sha+"&n="+this.file_name+".mdb";this.$alert("","分享阅读链接",{showInput:!0,inputValue:t})}else this.$prompt("请输入文件名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^([0-9a-zA-z]{1})([\w]*)$/g,inputPlaceholder:this.file_name,inputErrorMessage:"文件格式不正确"}).then((function(t){var n=t.value;e.file_config.files.has(n)?e.$message({type:"warning",message:"已存在该文件名"}):(e.file_name=n,e.tool_bar_list[e.tool_map["file"]].title=e.file_name,e.$message({type:"success",message:"修改成功"}))})).catch((function(){e.$message({type:"info",message:"取消输入"})}))},__get_gitee_files:function(){var e=this;""!=this.gitee_info.username&&""!=this.gitee_info.repos&&""!=this.gitee_info.token?(this.file_config.loading=!0,this.gAPI.get_files().then((function(t){var n=t.data.tree;e.file_config.groups.splice(0,e.file_config.groups.length);for(var i=0;i<n.length;i++)if("MarkBox_file_groups"==n[i].path){e.gAPI.get_file_by_sha(n[i].sha).then((function(t){e.file_config.groups=JSON.parse(e.__decode(t.data.content))})).catch((function(){e.file_config.groups.push({name:"files",list:[]})})).finally((function(){for(var t=new Set,i=new Set,o={},a=1;a<e.file_config.groups.length;a++)e.file_config.groups[a].list.forEach((function(n){t.add(n.path.split("."+e.file_type)[0])}));e.file_config.groups[0].list.splice(0,e.file_config.groups[0].list.length);for(var s=0;s<n.length;s++){var r=n[s].path.split(".");if(r[r.length-1]==e.file_type){var c=n[s].path.split("."+e.file_type)[0];e.file_config.files.add(c),t.has(c)?(i.add(c),o[c]=n[s]):e.file_config.groups[0].list.push(n[s])}}function l(e,t){var n,i=new Set(e),o=Object(f["a"])(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;i.delete(a)}}catch(s){o.e(s)}finally{o.f()}return i}for(var u=l(t,i),d=function(t){e.file_config.groups[t].list.forEach((function(n,a){var s=n.path.split("."+e.file_type)[0];if(u.has(s)&&e.file_config.groups[t].list.splice(a,a+1),i.has(s))for(var r in n)n[r]=o[s][r]}))},_=1;_<e.file_config.groups.length;_++)d(_);e.file_config.loading=!1}));break}e.file_config.groups.push({name:"Files",list:[]});for(var o=0;o<n.length;o++){var a=n[o].path.split(".");a[a.length-1]==e.file_type&&e.file_config.groups[0].list.push(n[o])}e.file_config.loading=!1})).catch((function(){e.file_config.loading=!1}))):this.$notify({title:" 失败",message:"Gitee 信息有误"})},__load_gitee_file:function(e,t){var n=this;""!=this.gitee_info.username&&""!=this.gitee_info.repos&&""!=this.gitee_info.token?this.can_request()&&(this.send_a_request(),this.loading=!0,this.file_config.show=!1,this.gAPI.get_file_by_sha(t).then((function(i){n.mddata=n.__decode(i.data.content),n.editor.setValue(n.mddata),n.file_name=e.split(".mdb")[0],n.file_sha=t,n.tool_bar_list[n.tool_map["file"]].title=n.file_name,n.loading=!1,n.online_file=!0,document.getElementsByTagName("title")[0].innerText=n.file_name})).catch((function(){n.loading=!1}))):this.$notify({title:" 失败",message:"Gitee 信息有误"})},__upload_pic_to_itee_file:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.pushed_pic_config.base64.substring(22),n=this.pushed_pic_config.name,e.abrupt("return",new Promise((function(e,o){return""==i.gitee_info.username||""==i.gitee_info.repos||""==i.gitee_info.token?(i.$notify({title:" 失败",message:"Gitee 信息有误"}),o(!1),!1):(i.pushed_pic_config.loading=!0,i.can_request()?(i.send_a_request(),void i.gAPI.get_file_by_path(n).then((function(a){if(0==a.data.length){var s={content:t};i.gAPI.new_file(n,s).then((function(t){i.$notify({title:"成功",message:n+" 上传成功！"}),i.pushed_pic_config.url=t.data.content.download_url,i.pushed_pic_config.loading=!1,e(t.data)})).catch((function(e){i.$notify({title:" 失败",message:e.data.responseJSON.message}),i.pushed_pic_config.loading=!1,o(e.data)}))}else i.$alert("是否替换图片"+n,"替换",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s={content:t,sha:a.data.sha};i.gAPI.update_file(n,s).then((function(t){i.$notify({title:"成功",message:n+" 替换成功！"}),i.pushed_pic_config.url=t.data.content.download_url,i.pushed_pic_config.loading=!1,e(t.data)})).catch((function(e){i.$notify({title:" 失败",message:e.data.responseJSON.message}),i.pushed_pic_config.loading=!1,o(e.data)}))})).catch((function(e){i.$notify({title:"取消替换",message:""}),i.pushed_pic_config.loading=!1,o(e.data)}))})).catch((function(){i.$notify({title:" 失败",message:"请求出错"}),i.pushed_pic_config.loading=!1}))):(o(!1),!1))})));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),__upload_gitee_file:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){return""==i.gitee_info.username||""==i.gitee_info.repos||""==i.gitee_info.token?(i.$notify({title:" 失败",message:"Gitee 信息有误"}),o(!1),!1):i.can_request()?(i.send_a_request(),void i.gAPI.get_file_by_path(t).then((function(a){if(0==a.data.length){var s={content:n};i.gAPI.new_file(t,s).then((function(n){i.$notify({title:"成功",message:t+" 上传成功！"}),i.file_sha=n.data.content.sha,i.file_name=n.data.content.name.split(".mdb")[0],e(n.data)})).catch((function(e){i.$notify({title:" 失败",message:e.data.responseJSON.message}),o(e.data)}))}else i.$alert("是否替换"+t,"替换",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s={content:n,sha:a.data.sha};i.gAPI.update_file(t,s).then((function(n){i.$notify({title:"成功",message:t+" 替换成功！"}),console.log(n.data),i.file_sha=n.data.content.sha,i.file_name=n.data.content.name.split(".mdb")[0],e(n.data)})).catch((function(e){i.$notify({title:" 失败",message:e.data.responseJSON.message}),o(e.data)}))})).catch((function(e){i.$notify({title:"取消替换",message:""}),o(e.data)}))})).catch((function(){i.$notify({title:" 失败",message:"请求出错"})}))):(o(!1),!1)})));case 1:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),__upload_to_gitee:function(){var e=this,t=this.editor.getValue(),n=this.__encode(t),i=this.file_name+"."+this.file_type;this.loading=!0,this.__upload_gitee_file(i,n).then((function(){e.loading=!1})).catch((function(){e.loading=!1}))},__upload_file_group:function(){var e=this,t=this.__encode(JSON.stringify(this.file_config.groups)),n="MarkBox_file_groups";return new Promise((function(i,o){return""==e.gitee_info.username||""==e.gitee_info.repos||""==e.gitee_info.token?(e.$notify({title:" 失败",message:"Gitee 信息有误"}),o(!1),!1):(e.file_config.loading=!0,e.can_request()?(e.send_a_request(),void e.gAPI.get_file_by_path(n).then((function(a){if(0==a.data.length){var s={content:t};e.gAPI.new_file(n,s).then((function(t){e.$notify({title:"成功",message:n+" 上传成功！"}),e.file_config.loading=!1,i(t.data)})).catch((function(t){e.$notify({title:" 失败",message:t.data.responseJSON.message}),e.file_config.loading=!1,o(t.data)}))}else{var r={content:t,sha:a.data.sha};e.gAPI.update_file(n,r).then((function(t){e.$notify({title:"成功",message:n+" 替换成功！"}),e.file_config.loading=!1,i(t.data)})).catch((function(t){e.$notify({title:"取消",message:""}),e.pushed_pifile_configc_config.loading=!1,o(t.data)}))}})).catch((function(){e.$notify({title:" 失败",message:"请求出错"}),e.file_config.loading=!1}))):(o(!1),!1))}))},__delete_file_group:function(e){console.log(e),this.file_config.groups.splice(e,e+1)},__add_file_group:function(){var e=this;this.$prompt("请输入群组名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/[\w]+/,inputErrorMessage:"格式不正确"}).then((function(t){var n=t.value;e.file_config.groups.push({name:n,list:[]}),e.$message({type:"success",message:"新建群组: "+n})})).catch((function(){e.$message({type:"info",message:"取消输入"})}))},__encode:function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))},__decode:function(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},colorHex:function(e){var t=/^(rgb|RGB)/;if(t.test(e)){for(var n="#",i=e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),o=0;o<i.length;o++){var a=Number(i[o]).toString(16);"0"===a&&(a+=a),n+=a}return n}return String(e)},colorRgb:function(e){var t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(e=e.toLowerCase(),t.test(e)){if(4===e.length){for(var n="#",i=1;i<4;i+=1)n+=e.slice(i,i+1).concat(e.slice(i,i+1));e=n}for(var o=[],a=1;a<7;a+=2)o.push(parseInt("0x"+e.slice(a,a+2)));return"RGB("+o.join(",")+")"}return e},getElementsByAttr:function(e,t,n){for(var i=document.getElementsByTagName(e),o=0;o<=i.length;o++)if(i[o].getAttribute(t)==n)return i[o]}}},b=v,w=(n("e065"),n("fd74"),n("2877")),y=Object(w["a"])(b,l,u,!1,null,"99c2fb60",null),k=y.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bg"},[e.is_first_set?n("div",{staticClass:"board"},[n("p",{staticClass:"msg_board",style:{color:e.msg_color}},[e._v(e._s(e.msg))]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"text"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("div",{staticClass:"button",on:{click:function(t){return e.first_set()}}},[e._v("Submit")])]):n("div",{staticClass:"board"},[n("p",{staticClass:"msg_board"},[e._v(e._s(e.msg))]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"password"},domProps:{value:e.password},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login()},input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("div",{staticClass:"button",on:{click:function(t){return e.login()}}},[e._v("Login")])])])},C=[],$=n("d722"),S=$.checkFirst,P=$.login,j=$.firstSet,T=$.setToken,A={data:function(){return{msg:"This is the first time you enter this website, thus input your password at the beginning.",password:"",is_first_set:!0,msg_color:"black"}},mounted:function(){var e=this;S().then((function(t){e.is_first_set=t.data.is_first,console.log(t),e.is_first_set||(e.msg="Please input your password.")}))},methods:{first_set:function(){var e=this;if(this.password.length<6)return console.log(this.password),this.msg="Please input at least 6 characters.",this.msg_color="red",null;j({password:this.password}).then((function(t){e.msg="Success.",e.msg_color="green",console.log(t),e.is_first_set=!1}))},login:function(){var e=this;if(this.password.length<6)return console.log(this.password),this.msg="Please input at least 6 characters.",this.msg_color="red",null;P({password:this.password}).then((function(t){e.msg="Success.",e.msg_color="green",T(t.token),e.$router.push("/")}))}}},O=A,R=(n("2042"),Object(w["a"])(O,x,C,!1,null,"10ffc01d",null)),N=R.exports,I=n("8c4f"),E=new I["a"]({routes:[{path:"/",component:k,alias:"/markbox"},{path:"/login",component:N}]}),B=n("d722"),q=B.getToken,G=["/login"];E.beforeEach(function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n,i){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=q(),o?"/login"===t.path?i({path:"/"}):i():-1!==G.indexOf(t.path)?i():i("/login");case 2:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}());var z={router:E},M=z,J=(n("034f"),Object(w["a"])(M,s,r,!1,null,null,null)),K=J.exports;i["default"].use(I["a"]),i["default"].use(a.a),new i["default"]({el:"#app",render:function(e){return e(K)}})},"85ec":function(e,t,n){},be35:function(e,t,n){},c473:function(e,t,n){},d722:function(e,t,n){n("d3b7"),n("96cf");var i=n("c973"),o=n("bc3a").default;function a(e){this.username=e.username,this.token=e.token,this.repos=e.repos}a.prototype={get_files:function(){var e=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",o({method:"get",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/git/trees/master",responseType:"json",headers:{Authorization:"token "+this.token}}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),get_file_by_sha:function(){var e=i(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",o({method:"get",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/git/blobs/"+t,responseType:"json",headers:{Authorization:"token "+this.token}}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),get_file_by_path:function(){var e=i(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",o({method:"get",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/contents/"+t,responseType:"json",headers:{Authorization:"token "+this.token}}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),new_file:function(){var e=i(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={access_token:this.token,owner:this.username,repo:this.repos,path:t,message:"[new file] "+t,content:n.content},e.abrupt("return",o({method:"post",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/contents/"+t,responseType:"json",headers:{Authorization:"token "+this.token},data:n}));case 2:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),update_file:function(){var e=i(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={access_token:this.token,owner:this.username,repo:this.repos,path:t,message:"[update file] "+t,content:n.content,sha:n.sha},e.abrupt("return",o({method:"put",url:"https://gitee.com/api/v5/repos/"+this.username+"/"+this.repos+"/contents/"+t,responseType:"json",headers:{Authorization:"token "+this.token},data:n}));case 2:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()};var s=n("852e"),r="User-Token";function c(){return s.get(r)}function l(e){return s.set(r,e)}function u(){return s.remove(r)}var f=o.create({baseURL:"",timeout:5e3});function d(){return _.apply(this,arguments)}function _(){return _=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",f({method:"get",url:"/api/giteeinfo",responseType:"json"}));case 1:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function h(){return p.apply(this,arguments)}function p(){return p=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",f({method:"get",url:"/api/is_first"}));case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return m=i(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",f({method:"post",url:"/api/first_set",data:t}));case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function v(e){return b.apply(this,arguments)}function b(){return b=i(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",f({url:"/api/login",method:"post",data:t}));case 1:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}f.interceptors.request.use((function(e){var t=c();return t&&(e.headers["Authorization"]=t),e}),(function(e){return Promise.reject(e)})),f.interceptors.response.use((function(e){var t=e.data||{};return-1==t.code?Promise.reject(new Error(t.msg||"Error")):t}),(function(e){var t=e.response||{};return 401===t.status&&u(),Promise.reject(e)})),e.exports={GiteeAPI:a,checkFirst:h,firstSet:g,login:v,getGiteeInfo:d,setToken:l,getToken:c,removeToken:u}},e065:function(e,t,n){"use strict";n("3f1b")},fab6:function(e,t,n){},fd74:function(e,t,n){"use strict";n("fab6")}});
//# sourceMappingURL=index.dcbbdada.js.map